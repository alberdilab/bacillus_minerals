[["index.html", "AlberdiLab | Carbajo et al. 2026 Study in progress Chapter 1 Introduction 1.1 Prepare the R environment", " AlberdiLab | Carbajo et al. 2026 Study in progress Carlota Carbajo, Nanna Gaun, Antton Alberdi1, Karina Sand Last update: 2026-01-23 Chapter 1 Introduction This webbook contains all the code used for data analysis in study of gut microbiomes of newts across ponds included in a restoration plan. 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/alberdilab/bacillus_minerals.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(rairtable) library(janitor) library(broom) University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["prepare-data.html", "Chapter 2 Prepare data 2.1 Bioinformatics 2.2 Load data 2.3 Preliminary visualisations", " Chapter 2 Prepare data 2.1 Bioinformatics 2.1.1 Get data mkdir genome wget -P genome https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/009/045/GCF_000009045.1_ASM904v1/GCF_000009045.1_ASM904v1_genomic.fna.gz mkdir reads # fetch data from ERDA 2.1.2 Run annotation and profiling drakkar annotating -b genome drakkar expressing -b genome -r reads 2.1.3 Get working files gene_annotations.tsv.xz gene_counts.tsv.xz 2.2 Load data read_counts &lt;- read_tsv( &quot;data/gene_counts.tsv.xz&quot;, comment = &quot;#&quot;, # skip featureCounts metadata col_names = TRUE, # header is present show_col_types = FALSE # silence messages ) %&gt;% rename(gene = Geneid) %&gt;% pivot_longer(!c(gene,Chr,Start,End,Strand,Length),names_to=&quot;library&quot;,values_to = &quot;counts&quot;) %&gt;% mutate(sample = str_extract(library, &quot;^[^_]+&quot;)) %&gt;% group_by(gene,Chr,Start,End,Strand,Length,sample) %&gt;% summarise(counts=sum(counts)) %&gt;% pivot_wider(c(gene,Chr,Start,End,Strand,Length), names_from = &quot;sample&quot;, values_from = &quot;counts&quot;) gene_annotations &lt;- read_tsv(&quot;data/gene_annotations.tsv.xz&quot;) %&gt;% rename(gene=1) sample_metadata &lt;- read_csv(&quot;data/sample_metadata.csv&quot;) 2.3 Preliminary visualisations read_counts %&gt;% pivot_longer(!c(gene,Chr,Start,End,Strand,Length),names_to=&quot;sample&quot;,values_to = &quot;counts&quot;) %&gt;% group_by(sample) %&gt;% summarise(counts=sum(counts)) %&gt;% ggplot(aes(x=sample,y=counts)) + geom_bar(stat=&quot;identity&quot;) inner_join(read_counts,gene_annotations %&gt;% select(gene,kegg),by=&quot;gene&quot;) %&gt;% pivot_longer(!c(gene,Chr,Start,End,Strand,Length,kegg),names_to=&quot;sample&quot;,values_to = &quot;counts&quot;) %&gt;% group_by(sample,kegg) %&gt;% summarise(counts=sum(counts)) %&gt;% ggplot(aes(x=sample,y=kegg,fill=log(counts))) + geom_tile() Dwfssdf semgf sdgm "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
